% columns: n_attractors, n_hidden, replication_count, mean, sd
% obtained by running dt t 2 t 3 d 5 < output.txt

d125=[
             25          50  00000005   0.046176   0.054668 
          25         100  00000005   0.024814   0.012141 
          25         150  00000005   0.056004   0.024344 
          25         200  00000005   0.053437   0.004658 
          50          50  00000005   0.358246   0.154304 
          50         100  00000005   0.082128   0.012705 
          50         150  00000005   0.105732   0.012196 
          50         200  00000005   0.158377   0.008581 
          75          50  00000005   0.541978   0.011695 
          75         100  00000005   0.200537   0.018221 
          75         150  00000005   0.226732   0.010948 
          75         200  00000005   0.384915   0.010064 
         100          50  00000005   0.639616   0.003987 
         100         100  00000005   0.325241   0.017394 
         100         150  00000005   0.414501   0.013408 
         100         200  00000005   0.578997   0.018458 
         125          50  00000005   0.733467   0.003679 
         125         100  00000005   0.536619   0.011855 
         125         150  00000005   0.536747   0.005939 
         125         200  00000005   0.703206   0.005039 
         150          50  00000005   0.798278   0.003603 
         150         100  00000005   0.639498   0.005959 
         150         150  00000005   0.608753   0.008501 
         150         200  00000005   0.794763   0.012221 
         175          50  00000005   0.846884   0.003913 
         175         100  00000005   0.701892   0.005176 
         175         150  00000005   0.665521   0.004292 
         175         200  00000005   0.872923   0.010209 
         200          50  00000005   0.883668   0.006275 
         200         100  00000005   0.741118   0.003807 
         200         150  00000005   0.709524   0.005642 
         200         200  00000005   0.929998   0.008154 
         225          50  00000005   0.907247   0.001916 
         225         100  00000005   0.772685   0.006262 
         225         150  00000005   0.750539   0.001850 
         225         200  00000005   .21+0.757985   0.007493 % buggy -- rerun
         250          50  00000005   0.927461   0.003022 
         250         100  00000005   0.800442   0.004682 
         250         150  00000005   0.783563   0.005133 
         250         200  00000005   .21+0.785284   0.007685 % buggy -- rerun
   ];
d250=[
             25          50  00000005   0.011775   0.005659 
          25         100  00000005   0.009808   0.002397 
          25         150  00000005   0.008133   0.002979 
          25         200  00000005   0.009515   0.001761 
          50          50  00000005   0.137955   0.010534 
          50         100  00000005   0.034731   0.002614 
          50         150  00000005   0.034260   0.003365 
          50         200  00000005   0.033665   0.002697 
          75          50  00000005   0.375534   0.008956 
          75         100  00000005   0.060144   0.005213 
          75         150  00000005   0.057330   0.005804 
          75         200  00000005   0.082781   0.005488 
         100          50  00000005   0.549374   0.007151 
         100         100  00000005   0.115542   0.006083 
         100         150  00000005   0.088519   0.007602 
         100         200  00000005   0.153574   0.015483 
         125          50  00000005   0.644678   0.008814 
         125         100  00000005   0.191287   0.005338 
         125         150  00000005   0.133790   0.008236 
         125         200  00000005   0.331951   0.021810 
         150          50  00000005   0.713126   0.005469 
         150         100  00000005   0.265300   0.007394 
         150         150  00000005   0.235653   0.018367 
         150         200  00000005   0.500850   0.015609 
         175          50  00000005   0.759221   0.006887 
         175         100  00000005   0.381332   0.011460 
         175         150  00000005   0.430978   0.022843 
         175         200  00000005   0.583614   0.004195 
         200          50  00000005   0.800415   0.003830 
         200         100  00000005   0.467985   0.004969 
         200         150  00000005   0.582483   0.009623 
         200         200  00000005   0.639829   0.004498 
         225          50  00000005   0.837119   0.004887 
         225         100  00000005   0.578935   0.017432 
         225         150  00000005   0.676018   0.015516 
         225         200  00000005   0.688639   0.005991 
         250          50  00000005   0.872552   0.001997 
         250         100  00000005   0.679779   0.015394 
         250         150  00000005   0.723822   0.003591 
         250         200  00000005   0.725731   0.005735 
   ];
d500=[
          25          50  00000005   0.005723   0.001361 
          25         100  00000005   0.006432   0.000602 
          25         150  00000005   0.007182   0.001409 
          25         200  00000005   0.007718   0.001095 
          50          50  00000005   0.197476   0.007430 
          50         100  00000005   0.025686   0.002180 
          50         150  00000005   0.024022   0.002795 
          50         200  00000005   0.030320   0.003355 
          75          50  00000005   0.593825   0.019381 
          75         100  00000005   0.074155   0.006013 
          75         150  00000005   0.067477   0.010466 
          75         200  00000005   0.177928   0.025990 
         100          50  00000005   0.825767   0.008779 
         100         100  00000005   0.226336   0.029663 
         100         150  00000005   0.173687   0.026306 
         100         200  00000005   0.453899   0.043544 
         125          50  00000005   0.945881   0.004100 
         125         100  00000005   0.435310   0.010726 
         125         150  00000005   0.489911   0.028567 
         125         200  00000005   0.642274   0.011786 
         150          50  00000005   1.012703   0.015725 
         150         100  00000005   0.616319   0.019162 
         150         150  00000005   0.720189   0.032294 
         150         200  00000005   0.758586   0.009634 
         175          50  00000005   1.077449   0.010760 
         175         100  00000005   0.723246   0.011882 
         175         150  00000005   0.832918   0.008698 
         175         200  00000005   0.865401   0.010353 
         200          50  00000005   1.109923   0.008217 
         200         100  00000005   0.864467   0.010205 
         200         150  00000005   0.932721   0.017443 
         200         200  00000005   0.938605   0.016361 
         225          50  00000005   1.163011   0.012870 
         225         100  00000005   0.965772   0.015915 
         225         150  00000005   1.011588   0.010491 
         225         200  00000005   1.020044   0.006867 
         250          50  00000005   1.195878   0.010508 
         250         100  00000005   1.062675   0.010083 
         250         150  00000005   1.060604   0.012795 
         250         200  00000005   1.070382   0.013941 
];

noise_level = {'0.125' '0.250' '0.500'};
% picked for colorblind
col = [179 205 227; 140 150 198; 136 86 167; 129 15 124]/255;
col = [161 218 180; 65 182 196; 44 127 184; 37 52 148]/255;
col = [158 188 218; 140 150 198; 136 86 167; 129 15 124]/255;
for fign = 1:3
   subplot(1,3,fign)
   if (fign==1) 
      d = d125;
   elseif (fign==2)
      d = d250;
   else
      d = d500;
   end
   
   n_hids = sort(unique(d(:,2)));
   n_atts = sort(unique(d(:,1)));
   m=zeros(length(n_atts),length(n_hids));
   s = m;
   for i = 1:length(n_hids)
      for j=1:length(n_atts)
         r = d(:,1)==n_atts(j)&d(:,2)==n_hids(i);
         m(j,i) = d(r,4);
         s(j,i) = d(r,5)/sqrt(d(r,3));
      end
   end
   hold off
   for c = 1:4
       errorbar(n_atts,1-m(:,c),s(:,c),'color',col(c,:),'linewidth',1.5)
       hold on
   end
   xlabel('Number of Attractors ($A$)', 'interpreter', 'latex')
   set(gca,'xtick',n_atts)
   q=[repmat('$n = ',length(n_hids),1) num2str(n_hids) repmat('$ hid',length(n_hids),1)];
   if (fign==2)
      qqq=legend(q,'location','southwest');
      qqq.Interpreter = 'latex';
   end 
   zz=ylabel('\% Noise Variance Removed','interpreter','latex');
   vv = get(zz,'position');
   vv(1)= -45;
   vv(2)=.44;
   set(zz,'position',vv)
   set(gca,'ytick',0:.2:1)
   set(gca,'yticklabel',{'0%' '20%' '40%' '60%' '80%' '100%'})
   set(gca,'xtick',[0 50 100 150 200 250])
   set(gca,'ylim',[-.15 1])
   set(gca,'xlim',[0 250])
   title(['\sigma = ',noise_level{fign}])
end
set(gcf,'position',[10 10 712 189])
set(gcf,'PaperPositionMode','auto')
print2pdf plot_attractor_performance.pdf
